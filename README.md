# Covid19 Segmentation with U-Net
In this study, a conventional U-Net was utilized to segment Covid-19 infections from the healthy areas of the chest based on CT images. Different classical data augmentation techniques were used to enhance the performance of segmentation. Two datasets have been utilized and two different loss functions, binary cross entropy and focal loss have been analysed and compared. Below table demonstrates dice score, specificity and sensitivity of U-Net model for each dataset and each loss function.

![Unet_Bacholar-1](https://github.com/ErshadHasanpour/Covid19-Segmentation-with-U-Net/assets/96794427/d136a534-fb84-4f15-a39f-d2ff5d5f2885)

The corresponding metrics for the second dataset are much better than the first dataset, meaning the network outputs for the third and fourth states are considerably more accurate than the outputs for the first and second states. The main reason for this is that the second dataset was larger than the first dataset, and the network learns better with a larger dataset.For each of the two datasets (especially the first dataset which is smaller), the BinaryFocalLoss cost function, which helps the network in learning difficult areas of infection, performed better than the binary-crossentropy cost function, and the network performance with this cost function was higher. Although the difference between these two cost functions is not much for the second dataset, for the first dataset this difference was very significant, and it can be concluded that, at least in this study, the BinaryFocalLoss cost function is better and more suitable for semantic segmentation, particularly when dataset is small. Another advantage of this cost function over the binary-crossentropy loss function is that it does not detect edges as infection. In fact, as we see below, the network with binary-crossentropy cost function for the first dataset detects edges as infection as well, while with BinaryFocalLoss cost function it is not like that.

![Unet_Bacholar_2](https://github.com/ErshadHasanpour/Covid19-Segmentation-with-U-Net/assets/96794427/00e7eeb4-3a05-40f5-b191-602851f0edca)

In conclusion, the BinaryFocalLoss cost function demonstrated advantages not only in terms of quantitative performance assessment, but also with respect to qualitative evaluation.
